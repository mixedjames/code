---
title: "DOS2020: Global project structure"
author: James Heggie
date: 23/05/2021
keywords: DOS 2020
description: What goes where?
---

::: {.technical-notes}
This page is a technical note made by me for me - it is not a freestanding
article. If it's helpful to you, great; if not, sorry.
:::

# Top-level directory structure

--------------------------------------------------------------------------------
Directory What it's for
--------- ----------------------------------------------------------------------
CODE      Projects; each in their own subdirectory

H         Public header files generated by projects. *Don't edit these files
          here*, they're copied here automatically by the individual projects
          as part of their build process.

LIB       Library files

--------------------------------------------------------------------------------

# Why is everything uppercase?
:::{.info-box}
TL;DR: because I want the project to work with DOS file systems and Linux
filesystems - uppercase is the easiest common convention.
:::

### The longer version...
Yes, I know, all uppercase filenames are ugly. However...

Various different filesystems have different rules for case...

- DOS (FAT12, FAT16) - New files will be uppercase; case-insensitive; possibly
  case preserving?
- Windows (VFAT, NTFS) - Case-insensitive but case-preserving
- Linux-likes (ext3 etc.) - Case-sensitive and case-preserving

I may well create new files (either manually or via tools) in DOS and these
might well get incorporated into the project. I also might not notice that
it's happened.

If we make everything uppercase and 8.3 then DOS will never change these
filenames and Windows/Linux will always preserve them. Hopefully this will
avoid build-breaking changes.

# How are the library files named?

We only have 8 characters and several things need to be encoded...

- Some sort of unique name
- Compiler
- 16 vs 32bit
- Memory module

### Mushing it all into the filename

Insanity lies this way I think...
```
jlib system(1 char) bits(2 char) model(1 char)

JLIBM32 (M = Microsoft Visual C, 32 = 32 bit)
JLIBB16S (B = Borland, 32 = 32 bit, s = small)
```

The problem ends up being that it's not very extensible - it's fine when I only
use a few build systems but what if I use several versions of Borland for
example? The encoding ends up very non-obvious.

### Adding some subdirectories

I think splitting into subdirectories by build system leads to a more acceptable
encoding...

```
MSV1.5
  /JLIB16S.LIB
  /JLIB16L.LIB

BC5
  /JLIB16S.LIB
  /JLIB16L.LIB
  /JLIB32.LIB
```

This way each build system contains 1, 2 or 3 libraries (depending on what
versions they support) and adding a new build system just adds a single
extra directory