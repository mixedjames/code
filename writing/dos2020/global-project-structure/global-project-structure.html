<header class="content-header">
<h1 class="title">DOS2020: Global project structure</h1>
<p class="author">James Heggie</p>
<p class="date">23/05/2021</p>
</header>

<div class="technical-notes">
<p>This page is a technical note made by me for me - it is not a freestanding article. If it’s helpful to you, great; if not, sorry.</p>
</div>
<section id="top-level-directory-structure" class="level1">
<h1>Top-level directory structure</h1>
<table>
<colgroup>
<col style="width: 12%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="header">
<th>Directory</th>
<th style="text-align: left;">What it’s for</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CODE</td>
<td style="text-align: left;">Projects; each in their own subdirectory</td>
</tr>
<tr class="even">
<td>H</td>
<td style="text-align: left;">Public header files generated by projects. <em>Don’t edit these files here</em>, they’re copied here automatically by the individual projects as part of their build process.</td>
</tr>
<tr class="odd">
<td>LIB</td>
<td style="text-align: left;">Library files</td>
</tr>
</tbody>
</table>
</section>
<section id="why-is-everything-uppercase" class="level1">
<h1>Why is everything uppercase?</h1>
<div class="info-box">
<p>TL;DR: because I want the project to work with DOS file systems and Linux filesystems - uppercase is the easiest common convention.</p>
</div>
<section id="the-longer-version" class="level3">
<h3>The longer version…</h3>
<p>Yes, I know, all uppercase filenames are ugly. However…</p>
<p>Various different filesystems have different rules for case…</p>
<ul>
<li>DOS (FAT12, FAT16) - New files will be uppercase; case-insensitive; possibly case preserving?</li>
<li>Windows (VFAT, NTFS) - Case-insensitive but case-preserving</li>
<li>Linux-likes (ext3 etc.) - Case-sensitive and case-preserving</li>
</ul>
<p>I may well create new files (either manually or via tools) in DOS and these might well get incorporated into the project. I also might not notice that it’s happened.</p>
<p>If we make everything uppercase and 8.3 then DOS will never change these filenames and Windows/Linux will always preserve them. Hopefully this will avoid build-breaking changes.</p>
</section>
</section>
<section id="how-are-the-library-files-named" class="level1">
<h1>How are the library files named?</h1>
<p>We only have 8 characters and several things need to be encoded…</p>
<ul>
<li>Some sort of unique name</li>
<li>Compiler</li>
<li>16 vs 32bit</li>
<li>Memory module</li>
</ul>
<section id="mushing-it-all-into-the-filename" class="level3">
<h3>Mushing it all into the filename</h3>
<p>Insanity lies this way I think…</p>
<pre><code>jlib system(1 char) bits(2 char) model(1 char)

JLIBM32 (M = Microsoft Visual C, 32 = 32 bit)
JLIBB16S (B = Borland, 32 = 32 bit, s = small)</code></pre>
<p>The problem ends up being that it’s not very extensible - it’s fine when I only use a few build systems but what if I use several versions of Borland for example? The encoding ends up very non-obvious.</p>
</section>
<section id="adding-some-subdirectories" class="level3">
<h3>Adding some subdirectories</h3>
<p>I think splitting into subdirectories by build system leads to a more acceptable encoding…</p>
<pre><code>MSV1.5
  /JLIB16S.LIB
  /JLIB16L.LIB

BC5
  /JLIB16S.LIB
  /JLIB16L.LIB
  /JLIB32.LIB</code></pre>
<p>This way each build system contains 1, 2 or 3 libraries (depending on what versions they support) and adding a new build system just adds a single extra directory</p>
</section>
</section>